---
title: "A Look Back at Long Lake"
output: 
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{A Look Back at Long Lake}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(CSLSlevels)
library(dplyr)
library(lubridate)
library(magick)
library(cowplot)
library(ggplot2)
library(ggspatial)
library(extrafont)

# Parameters
text_size      <- 12
max_depth_lims <- 1.2

# Photo observations (location & dates)
obs_loc     <- data.frame(x = -89.448499, y = 44.204690)
obs_loc_64  <- data.frame(x = -89.454793, y = 44.208161)
photos_1964 <- as_datetime(ymd("1964-10-01"))
photos_2005 <- as_datetime(ymd("2005-01-01"))
photos_2006 <- as_datetime(ymd(c("2006-07-01", "2006-09-01")))
photos_2007 <- as_datetime(ymd("2006-12-01"))
photos_2009 <- as_datetime(ymd("2009-08-01"))
photos_2010 <- as_datetime(ymd("2010-07-01"))

photos_all_2000s <- c(photos_2005, photos_2006, photos_2007, photos_2009, photos_2010)

# Lake level data
lake        <- "Long"
csls_levels <- CSLSlevels::csls_levels
lake_levels <- subset(csls_levels, lake_name == sprintf("%s Lake", lake)) %>%
               mutate(obs_mo = as_datetime(obs_mo))
long_limits <- c(min(lake_levels$lake_lev_pred, na.rm = TRUE),
                 max(lake_levels$lake_lev_pred, na.rm = TRUE))

lake_levels_2000s  <- lake_levels %>%
                      filter(year(obs_mo) > 1999,
                             year(obs_mo) <= 2012)
lake_levels_1960s  <- lake_levels %>%
                      filter(year(obs_mo) > 1955,
                             year(obs_mo) <= 1968)
photo_levels_2000s <- lake_levels %>%
                      filter(obs_mo %in% photos_all_2000s,
                             !is.na(lake_lev_obs))
photo_levels_1960s <- lake_levels %>%
                      filter(obs_mo %in% photos_1964,
                             !is.na(lake_lev_obs))

# Exceedance probabilities
ranked_annual      <- rank_lake_levels(lake_levels, 
                                       window_start = 1981, 
                                       window_end = 2018,
                                       lake_names = "Long Lake")
photo_levels_1960s$prob <- approx(x = ranked_annual$level,
                                  y = ranked_annual$prob,
                                  xout = photo_levels_1960s$lake_lev_obs)$y
photo_levels_2000s$prob <- approx(x = ranked_annual$level,
                                  y = ranked_annual$prob,
                                  xout = photo_levels_2000s$lake_lev_obs)$y

# Plotting functions
plot_historical_series <- function(df_obs, df_photos){
  plot_obj <- ggplot() +
              geom_line(data = df_obs,
                        aes(x = obs_mo, y = lake_lev_pred)) +
              geom_point(data = df_obs,
                         aes(x = obs_mo, y = lake_lev_obs)) +
              geom_point(data = df_photos,
                         aes(x = obs_mo, y = lake_lev_obs),
                         color = "red") +
              theme_bw() +
              labs(y = "Lake Level (mamsl)",
                   x = "Observation Date") +
              scale_x_datetime(expand = c(0,0)) +
              scale_y_continuous(limits = long_limits) +
              theme(text = element_text(family = "Segoe UI Semilight",
                                        size = text_size),
               panel.grid.minor = element_blank())
  return(plot_obj)
}

plot_exceedance_curve <- function(df_ranked, df_photos){
  plot_obj <- ggplot() +
              geom_line(data = df_ranked,
                        aes(x = prob, y = level),
                        color = "black") +
              geom_point(data = df_photos,
                         aes(x = prob, y = lake_lev_obs),
                         color = "red",
                         size = 2) +
              scale_x_continuous(expand = c(0, 0)) +
              labs(x = "Exceedance Probability (%)",
                   y = "") +
              scale_y_continuous(limits = long_limits) +
              theme_bw() +
              theme(text = element_text(family = "Segoe UI Semilight",
                                        size = text_size),
              panel.grid.minor = element_blank())
  return(plot_obj)  
}

```

## How could lake levels at Long Lake be lower in 1964 than in 2007?

One aspect of Long Lake's history that can be puzzling to those who know how dry
the lake was in the early 2000s is that levels are recorded as being *even
lower* in 1964. Personal photos from 2009 depict the eastern shore of Long Lake
as a dense meadow of vegetation with no visible standing water. The year 2007
saw even lower lake levels and is particularly memorable as a year that the lake
"dried up" as seen from the shoreline. By contrast, a personal photo from a
homewoner dated 1964 shows standing water clearly visible from the northern
shoreline. Yet 1964 lake levels are the lowest ever documented: 11 cm below 2007
levels, 28 cm below 2006 levels, and 40 cm below 2009 levels.

<br>

**How can this be?** To invesigate, we asked two specific questions:

 1. What do we know about lake level trends at Long Lake in the 1960s and 2000s?
 2. What did Long Lake look like in the 1960s and 2000s?
 
We first examined historic lake level observations, then paired these
observations with detailed lake bathymetry data collected as part of the WI
DNR's Central Sands Lakes Study. This allowed us to generate maps of lake depth
at historically observed lake levels that we could then pair with the shoreline
views that homeowners captured in their personal photos.

<br>

Ultimately, this exploration shows that the ecologic community of Long Lake
depends not only on the measured lake level, but also on how quickly and in
which direction lake levels are changing. Leading up to 1964, lake levels
declined too rapidly for dense vegetation to take root in the deepest parts of
the lake, which resulted in visible open water in personal photos. From 2006 to
2009, lake levels were marginally higher than in 1964, but remained at these
extremely low levels for so long that dense meadow vegetation was able to
establish and obscure views of open water from some shoreline locations. By
examining photodocumentation of Long Lake year-by-year, we show that it is
probable that lake levels were indeed lower in 1964 than they were in 2007.

## 1. What do we know about lake level trends at Long Lake in the 1960s and 2000s?

#### Lake levels trends in the 1960s {#levels1960s}
The data we have leading up to 1964 includes measurements taken by the county as
well as reconstructed monthly lake levels (Figure 1). These data show that lake
levels dropped 1.2 meters over the two years leading up to the measurement taken
by the county in October 1964. This means that photos taken in 1964 capture a
lake with rapidly declining lake levels.

```{r hist_1960s, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 3, fig.align="left", fig.cap="**Figure 1.** Long Lake water levels from 1964 (red points) in context with a longer historical record, as shown by a) reconstructed (line) and measured (points) lake levels at Long Lake from 1956-1968, and b) the lake level exceedance curve for all reconstructed monthly lake levels from 1981-2018, with the 1964 measurement shown as having over a 99% exceedance probability."}
plot_obs    <- plot_historical_series(lake_levels_1960s, photo_levels_1960s)
plot_exceed <- plot_exceedance_curve(ranked_annual, photo_levels_1960s)

plot_grid(plot_obs, plot_exceed,
         labels = c("(a)", "(b)"),
         label_x = 0.87, label_y = 0.97,
         label_fontfamily = "Segoe UI Semibold",
         label_size = text_size)
```

<br>

#### Lake levels trends in the 2000s {#levels2000s}
The data we have leading up to the 2006-2009 period shows that lake levels
dropped by 1.6 meters over the four years leading up to the low measurement
taken in August 2007. This is a slightly larger but more gradual decline than
what occurred in the 1960s. Importantly, lake levels were already within 18 cm
of the 2007 low by 2006. Based on this record of lake levels, the lake was
steadily declining in 2005 and 2006, slightly lower in 2007, and slowly
beginning to rise in 2009 and 2010.

```{r hist_2000s, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 3, fig.align="left", fig.cap="**Figure 2.** Long Lake water levels from the low period in 2005-2010 (red points = measurements with matching photos) in context with a longer historical record, as shown by a) reconstructed (line) and measured (points) lake levels at Long Lake from 2000-2012, and b) lake level exceedance curve for all reconstructed monthly lake levels from 1981-2018, with the 2006-2009 measurements shown as having over a 95% exceedance probability."}
plot_obs    <- plot_historical_series(lake_levels_2000s, photo_levels_2000s)
plot_exceed <- plot_exceedance_curve(ranked_annual, photo_levels_2000s)

plot_grid(plot_obs, plot_exceed,
         labels = c("(a)", "(b)"),
         label_x = 0.87, label_y = 0.97,
         label_fontfamily = "Segoe UI Semibold",
         label_size = text_size)
```

<br>

## 2. What did Long Lake look like in the 1960s and 2000s?

Photodocumentation on Long Lake in the 1960s is sparse, but we do have one
personal photo from 1964, collected by Maribeth Kniffin and included in her 2018
dissertation (Kniffin, 2018). As noted by others (Kraft and Mechenich, 2010, pg.
46), this photo shows that there was visible open water in Long Lake in 1964.

For the early 2000s, we are fortunate to have good photodocumentation of lake
levels thanks to homeowner Brian Wolf, who shared personal photos with George
Kraft from this time. According to Kraft and Wolf (personal comm., December
2019):

> *Brian and family bought their place on east end of Long Lake in April 2005.
> They were told the lake is a little low but it always comes back. Thatâ€™s where
> the photodocumentation begins.*

Here, we'll compare these photos with lake bathymetry maps corresonding to the
lake level measurmement taken nearest to the estimated date of the photo. Paired
photos and measurements exist for:

 * [Spring 2005](#pic05)
 * [Summer 2006](#pic06)
 * [Spring 2007](#pic07)
 * [Fall 2009](#pic09)
 * [Spring 2010](#pic10)
 * [Summer or Fall 1964](#pic64)

<br>

```{r compare, echo=FALSE, warning=FALSE, message=FALSE}
plot_bathy <- function(photo_dates, max_depth_lims, obs_loc = NULL) {
  lake_obs   <- lake_levels %>%
                filter(obs_mo %in% photo_dates)
  lake_level <- mean(lake_obs$lake_lev_obs, na.rm = TRUE)
  bathy      <- plot_lake_depths(lake, 
                                 lake_level,
                                 relative_depth_fill = FALSE,
                                 title_name = sprintf("%s Lake", lake),
                                 legend_position = "right",
                                 text_size = text_size) +
                scale_fill_distiller(palette = "Blues",
                                     direction = 1,
                                     limits = c(0, max_depth_lims))
  if (!is.null(obs_loc)) {
    bathy <- bathy + 
             geom_spatial_point(data = obs_loc, 
                                aes(x, y),
                                crs = 4326,
                                color = "red",
                                shape = 8,
                                size = 2.5)
  }
  return(bathy)
}

plot_im_bathy <- function(images, bathy, images2 = NULL) {
  plot_obj <- plot_grid(images, bathy, ncol = 1, 
                        labels = c("(a)","(b)"),
                        label_fontfamily = "Segoe UI Semibold",
                        label_size = text_size)
  if (!is.null(images2)) {
    plot_obj <- plot_grid(images, images2, bathy, ncol = 1, 
                        labels = c("(a)","(b)","(c)"),
                        label_fontfamily = "Segoe UI Semibold",
                        label_size = text_size)
  }
  return(plot_obj)
}
```

#### Spring 2005 {#pic05}

**Photos:** This photo, dated 2005, was taken at Wolf residence on the east side
of lake looking west (Kraft and Wolf, personal comm., December 2019). No month
is noted, but based on vegetation in the photo it looks to be early spring,
perhaps around when the Wolfs purchased their residence.

**Lake Levels:** The lake measurement closest to this date was taken by the
county in August 2005. Based on [Figure 2](#levels2000s), lake levels were in
the midst of a rapid decline and were about 1.0 meter lower than they had been
only 15 months earlier, in October 2003, but still 0.5 meter higher than they
would ultimately be 2 years later in August 2007.

**Observations:** By comparing the photo and lake bathymetry map during this
time of rapidly declining lake levels, we see that vegetation has not had time
to encroach upon the shoreline or the lake. Open water is promiment and the
extent of this open water appears to match reasonably closely with lake
shoreline depicted in the bathymetry map.

```{r pic2005, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 6.5, fig.align="left", fig.cap="**Figure 3.** Lake levels and depths in 2005 a) as seen from the east side of the lake, likely in March or April 2005, and b) as measured in January 2005. Red star indicates the approximate location where the picture was taken."}
images <- ggdraw() + draw_image("long_2005.jpg", scale = 0.8)
bathy  <- plot_bathy(photos_2005, max_depth_lims, obs_loc)
plot_im_bathy(images, bathy)
```

<br>

#### Summer 2006 {#pic06}
**Photos:** These photos were taken from the east side of Long Lake on two
different dates: the first two were taken on July 29, 2006, likely at two
different times of day, while the third was taken on September 5, 2006 (Kraft
and Wolf, personal comm., December 2019).

**Lake Levels:** There are two lake measurements near these dates: one derived
from a July 2006 aerial photos and another taken by the county in August 2006.
These measurements are within 2 cm of one another. Based on [Figure
2](#levels2000s), lake levels were continuing to decline, but were doing so much
more slowly. Levels were only 30 cm lower than they had been 18 months
previously in January 2005 and just 17 cm higher than they would ultimately be
the next year, in August 2007.

**Observations:** If we compare the lake shoreline depicted in this 2006
bathymetry map to the 2005 map in Figure 3b, it does not seem as though there
were substantial changes to the lakeshore over the intervening year. In the
photos, however, there is a dramatic difference in the amount of visible open
water. Vegetation has begun to colonize the shoreline as well as the shallows of
the lake. This results in the lake appearing more like a series of disconnected
pools rather than the contiguous body of (very shallow) water that is shown in
the bathymetry map. The growth and advance of vegetation is apparent even in the
one month between when photos were taken on July 29 (Figure 4a) and when an
additional photo was taken on September 5 (Figure 4b).

```{r pic2006, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 9.5, fig.align="left", fig.cap="**Figure 4.** Lake levels and depths in 2006 a) as seen from the east side of the lake on July 29, 2006 at two different times of day, b) from the same location on September 5, 2006, and c) as measured in July and September 2006 (levels within 1 cm of one another). Red star indicates the approximate location where the pictures were taken."}
im01   <- ggdraw() + draw_image("long_2006_07_im1.jpg", scale = 0.9)
im02   <- ggdraw() + draw_image("long_2006_07_im2.jpg", scale = 0.9)
im03   <- ggdraw() + draw_image("long_2006_09.jpg", scale = 0.8)
images <- plot_grid(im01, im02)
bathy  <- plot_bathy(photos_2006, max_depth_lims, obs_loc)
plot_im_bathy(images, bathy, im03)
```

<br>

#### Spring 2007 {#pic07}
**Photos:** This photo is dated March 29, 2007 but the location is uncertain
(Kraft and Wolf, personal comm., December 2019).

**Lake Levels:** The lake measurement closest to this date was taken by the
county in December 2006. At this time, lake levels were continuing to slowly
decline but were nearly as low as they ultimately became in August 2007. The
level measured in December 2006 is 8 cm lower than what was recorded in August
2006 and 8 cm higher than the August 2007 low (see [Figure 2](#levels2000s)).

**Observations:** Although the location of this photo is unkown, this image
shows that there was visible open water in at least one location in Long Lake
prior to the 2007 growing season. While vegetation growth may have obscured this
view over the course of the growing season, levels shown here are very similar
to (within 10 cm of) the low in August 2007.

```{r pic2007, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 6.5, fig.align="left", fig.cap="**Figure 5.** Lake levels and depths in 2007 a) as seen from an unknown location on March 29, 2007, and b) as measured in December 2006."}
images <- ggdraw() + draw_image("long_2007_03.jpg", scale = 0.8)
bathy  <- plot_bathy(photos_2007, max_depth_lims)
plot_im_bathy(images, bathy)
```

<br>

#### Fall 2009 {#pic09}
**Photos:** These photos were taken at the Wolf residence on the east side of
Long Lake on September 27, 2009 and in October 2009 (Kraft and Wolf, personal
comm., December 2019).

**Lake Levels:** The lake measurement closest to this date was taken by the
county in August 2009. At this time, lake levels had been slowly rising for two
years but were only 29 cm higher than in August 2007 (see [Figure
2](#levels2000s)). They were 12 cm higher than the levels observed in August
2006.

**Observations:** These photos really illustrate that the lake character is a
function of not only the current lake levels, but also how quickly and in which
direction lake levels are changing. Lake levels are actually 12 cm higher in
these photos than they are in the 2006 photos, but from some angles it is
impossible to see the open water through the dense meadow vegetation that has
taken root.

```{r pic2009, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 6.5, fig.align="left", fig.cap="**Figure 6.** Lake levels and depths in 2009 a) as seen from the east side of the lake on September 27, 2009 and in October 2010 and b) as measured in August 2009. Red star indicates the approximate location where the pictures were taken."}
im01   <- ggdraw() + draw_image("long_2009_09.jpg", scale = 0.9)
im02   <- ggdraw() + draw_image("long_2009_10.jpg", scale = 0.9)
images <- plot_grid(im01, im02)
bathy  <- plot_bathy(photos_2009, max_depth_lims, obs_loc)
plot_im_bathy(images, bathy)
```

<br>

#### Spring 2010 {#pic10}
**Photos:** This photo was taken at the Wolf residence on the east side of Long
Lake on April 17, 2010 (Kraft and Wolf, personal comm., December 2019).

**Lake Levels:** The lake measurement closest to this date was taken by the
county in July 2010. At this time, lake levels were beginning to rise more
rapidly and were 32 cm higher than they had been in August 2009, or a total of
71 cm higher than the low in August 2007 (see [Figure 2](#levels2000s)).

**Observations:** In this photo, the visible open water is up to 1.0 meter deep
in many locations and water levels are finally deep enough to flood the meadow
vegetation that took root during the years with very low water levels. The
shoreline visible in the photo is once again beginning to match the shoreline
depicted in the bathymetry map.

```{r pic2010, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 6.5, fig.align="left", fig.cap="**Figure 7.** Lake levels and depths in 2010 a) as seen from the east side of the lake on April 17, 2010, and b) as measured in July 2010. Red star indicates the approximate location where the picture was taken."}
images <- ggdraw() + draw_image("long_2010_04.jpg", scale = 0.8)
bathy  <- plot_bathy(photos_2010, max_depth_lims, obs_loc)
plot_im_bathy(images, bathy)
```

#### Spring or Fall 1964 {#pic64}

**Photos:** This photo, dated 1964, was taken from the north side of the lake
(Kniffin, 2018). The peninsula visible in the background is a unique feature on
the landscape that makes it possible to pinpoint the photo location more
precisely in Figure 8b. The exact date is unknown, but based on the attire of
the people in the photo and presence of leaves on deciduous trees, it was likely
taken during the warm weather season, perhaps in the summer or early fall.

**Lake Levels:** The lake measurement closest to this date was taken by the
county in October 1964. Based on [Figure 1](#levels1960s), lake levels had
rapidly declined 1.2 m over the previous two years, with most of that drop (0.8
m) occuring over the previous year. This is the lowest recorded measurement and
is 11 cm lower than the level recorded in August 2007 (see [Figure
2](#levels2000s)).

**Observations:** A 0.8 m drop in water levels in just one year is a very large
decline for this lake. While there are some signs in this photo that vegetation
has begun to encroach around the former shoreline, this drop appears to have
occurred too quickly and too recently for vegetation to have established yet.
Importantly, the bathymetry map indicates that in the absence of vegetation, we
would expect to see small ponds of water next to this property, as well as a
larger pond of water visible beyond.

```{r pic1964, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 6.5, fig.height = 6.5, fig.align="left", fig.cap="**Figure 8.** Lake levels and depths in 1964 a) as seen from the north side of the lake, likely in summer or early fall of 1964, and b) as measured in October 1964. Red star indicates the approximate location where the picture was taken."}
images <- ggdraw() + draw_image("long_1964.PNG", scale = 0.8)
bathy  <- plot_bathy(photos_1964, max_depth_lims, obs_loc_64)
plot_im_bathy(images, bathy)
```


## References

Kniffin, M. 2018. Investigations of Groundwater-Surface Water Interactions and
Stakeholder Engagement in the Central Sands Region of Wisconsin. PhD
dissertation. University of Wisconsin-Madison, Madison, WI.

Kraft, G. J. and D. J. Mechenich. 2010. Groundwater Pumping Effects on
Groundwater Levels, Lake Levels, and Streamflows in the Wisconsin Central Sands.
A Report to the Wisconsin Department of Natural Resources in Completion of
Project: NMI0000247.
